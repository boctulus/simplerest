Necesito clasificar unos productos que tengo en la base de datos "zippy" de MYSQL bajo la tabla "products"

Puedes consultar la tabla usando comandos "php com"

```
$ php com sql

BOCTULUS\SIMPLEREST\COMMANDS\SQL HELP

sql list '{db}.{table}' [--offset=N] [--limit=N] [--format=table]    

List contents of a table

‚Ñπ  {db} in this case is DB NAME, not "db name connection"

Examples:

php com sql list zippy.products
php com sql list zippy.products --limit=50 --format=table
```

Nota: hay mas comandos disponibles.

Hay categorias que podrian tener que crearse o existir ya pero con otro nombre con lo que tendrian que "mapearse"

Si ejecutas comandos del grupo de comandos "php com zippy" podras ver que posibilidades hay.

Necesito que proceses el primer lote de 200 products.

Nota: solo debes operar a traves de comandos "php com"


# MARCAS 

Se requiere que el comando `php com zippy brand categorize [ --limit= ] [ --dry-run ]` utilice un LLM, categorice casa marca y cree entonces un registro en la tabla `brand-categories`. Si no hubiera una seguridad absoluta para asignar la categoria (Ej: "ZUCAR FLAKES" hace referencia a un alimento azucarado) ya sea porque es demasiado obvio o porque la marca es conocida (Ej: XIAOMI lo es para smartphones) entonces de alguna forma de marcarse como "DUDOSA" o algo similar.

Ahora si, actualiza el metodo que resuelve la categoria de los productos para que comience utilizando informacion de la tabla `brand-categories` y si hay coincidencia esa categoria deba ser al menos la categoria padre. No podria asignarse una categoria que no tenga como padre o padre del padre,..etc a la categoria encontrada en `brand-categories`

Tablas:

- brands (migracion: `2025_11_14_160000000_create_brands.php`)
- brand_categories (migracion: `2025_11_14_170000000_create_brand_categories.php`)


Debo clasificar en categorias todos los products de la base de datos "zippy". Las categorias correspondientes podrian no existir por lo que debes apoyarte en los comandos "php com zippy" para que se vayan resolviendo y asignando.

Lee la documentacion del package "zippy".

Si necesitas consultar la base de datos "zippy" puedes apoyarte en los comandos "php com sql"

Si usas --limit para procesar el resto, recuerda luego usar --offset


# NOTAS

- Puedes analizar y tener en consideracion un "resumen ejecutivo" realizado por un LLM, el cual puede o ser correcto y debe tomarse como algo orientativo el siguiente documento:

D:\laragon\www\simplerest\packages\boctulus\zippy\RESUMEN-EJECUTIVO.md

- NO PROCESES MAS DE 20 PRODUCTOS HASTA ENTENDER SI TODO FUNCIONA Y SINO, DEBES PARAR, ANALIZAR Y REPORTARME.

- Deberias revisar *manualmente* (no con scripts) la clasificacion de los primeros 50 productos y luego al azar (con offset y limit) unos 50 productos mas como control de calidad para ajustar el threshold configurado porque hay que tener cuidado con productos como "PC EXO 5260 RETAIL DTI2" que fueron clasificados a pesar de no dar indicios de su categoria.

Solo despues de ajustar el threshod debes avanzar significativamente hasta terminar.

- Control de calidad:

Es obligatorio hacer un control de calidad revisando manualmente los primeros 50 productos y si pasa la prueba, los siguientes 50 y asi hasta los primeros 200 productos asegurando correcta clasificacion.

Algunos errores obvios:
```
A "NOTE DELL LAT U I7 16G512" se le asigna ["golosinas"]

A "AIRE ACON BGH BS52WCCR FC" se le asigna ["frutas-y-verduras"]

A "CALEF CTZ 9000TB GN" que es claramente un calefactor o algo similar se le asigna ["gourmetfood"] lo cual es doblemente incorrecto porque "gourmetfood" en todo caso seria "gourmet" o "gourmet food" o "gourmet-food" pero no "gourmetfood"
```

Puedes usar el comando "php com sql find" con --edit para resetear (por en NULL) las categorias errorneamente asignadas antes de volver a intentar re-clasificar. Sino ejecuta directamente `UPDATE `products` SET `categories`=null WHERE 1;` para la base de datos `zippy`

- Ajusta CategoryMapper.php si has encontrado un error.

Luego de corregir CategoryMapper.php si encuentras contiene errores, debes generar un reporte en un archivo .md dentro del modulo en `packages\boctulus\zippy\docs\issues\`

- Si alguna categoria o producto o mapping de categorias queda con error en la base de datos, asegurate de que quede corregido al final del proceso.


D:\laragon\www\simplerest\packages\boctulus\zippy\src\Libs\CategoryMapper.php


‚óè üìä Control de Calidad - Clasificaci√≥n de 50 Productos

  Resumen General

  - Procesados: 50 productos
  - Clasificados con √©xito: 40 productos (80%)
  - No clasificados: 10 productos (20%)
  - Errores: 0

  ‚úÖ Clasificaciones CORRECTAS (mejoras significativas)

  1. PEPSI COLA (165058, 298941) ‚Üí bebidas ‚úÖ (antes era "gourmetfood")
  2. EXO MINI RT320 (161801) ‚Üí electro ‚úÖ (antes era "golosinas")
  3. PC EXO 5260 (176910) ‚Üí electro ‚úÖ (antes era "frutas-y-verduras")
  4. FUNDA PARA CELULAR SAMSUNG (184665) ‚Üí electro ‚úÖ
  5. DELL notebooks (608715, 608717) ‚Üí electro ‚úÖ
  6. BGH (609679, 610338) ‚Üí electro ‚úÖ
  7. ARCOR productos (113857, 291318, 702732, 702733) ‚Üí golosinas ‚úÖ
  8. PAN ARABES (705875) ‚Üí panaderia ‚úÖ
  9. CHORIZO ALEMAN (705384) ‚Üí embutidos ‚úÖ

  üéØ El sistema de brand_categories est√° funcionando correctamente!

  ‚ö†Ô∏è Clasificaciones INCORRECTAS (necesitan correcci√≥n)

  1. HARINA TOSTADA (102369) ‚Üí clasificada como gourmetfood
    - Deber√≠a ser: almacen o alimentos-secos
  2. CALEF CTZ 9000TB GN (106400) ‚Üí clasificada como premium snacks and treats category
    - Deber√≠a ser: electro o electrodomesticos (es un calefactor)
    - Problema: Marca CTZ no est√° en brand_categories
  3. GRISINES (177233, 181538) ‚Üí clasificados como frutas-y-verduras
    - Deber√≠a ser: galletitas o panificados
  4. DCE/BATATA productos (varios) ‚Üí clasificados como frutas-y-verduras
    - Problema: "DCE" es dulce de batata, deber√≠a ser golosinas o dulces
  5. T/EMP productos (172297, 172298) ‚Üí clasificados como frutas-y-verduras
    - Problema: Son tapas de empanadas, deber√≠an ser pastas o panificados
  6. MEDALLON productos (217548, 231408, 231409) ‚Üí clasificados como frutas-y-verduras
    - Deber√≠a ser: congelados o carnes
  7. FID LA BNA P CINTA (296366) ‚Üí clasificada como frutas-y-verduras
    - Problema: Son fideos, deber√≠an ser pastas
  8. CALEF CTZ GN (607260) ‚Üí clasificada como frutas-y-verduras
    - Deber√≠a ser: electro (es calefactor)

  üîç An√°lisis de Problemas

  Problema Principal: La categor√≠a frutas-y-verduras sigue siendo usada como "catch-all" para productos ambiguos.

  Causas identificadas:
  1. Threshold 0.90 es muy estricto: Rechaza muchos casos leg√≠timos y luego el fallback asigna categor√≠as incorrectas
  2. Marcas sin categorizar: CTZ, LA JUVENTUD, ESNAOLA, etc. no tienen brand_categories
  3. Palabras clave confusas: "DCE" (dulce), "T/EMP" (tapas empanadas), "MEDALLON" no se reconocen correctamente

  üí° Recomendaciones

  1. Agregar marcas faltantes a brand_categories:
    - CTZ ‚Üí electro (calefactores)
    - LA JUVENTUD ‚Üí pastas (tapas de empanadas)
    - ESNAOLA ‚Üí golosinas (dulces)
  2. Bajar threshold a 0.85 para mejorar cobertura sin sacrificar calidad excesivamente
  3. Mejorar mapeo de palabras clave:
    - "CALEF" ‚Üí electro/electrodomesticos
    - "DCE" (dulce de...) ‚Üí golosinas/dulces
    - "T/EMP" (tapas empanadas) ‚Üí pastas/panificados
    - "MEDALLON" ‚Üí carnes/congelados
    - "GRISINES" ‚Üí galletitas/panificados

TO-DO

- Supongo es posible hacer llamadas el bloque de digamos 20 productos o categorias a la vez. El size del bloque podria ajustarse segun las capacidades del modelo. Podrias implementar a nivel de libreria y luego a nivel de comandos con el parametro opciona --block={size}

Implementar procesamiento por lotes (batch processing)

- Usando comandos "php com sql list zippy" y "php com sql list zippy.{tabla}" investigar el estado de las tablas (tienen datos? son coherentes?)

- Revisar el estado de los comandos del paquete "zippy"

- Cumplir con los objetivos de clasificacion cuyo objetivo final es clasificar los productos.


Notas:

No clasifiques marcas ni productos manualmente